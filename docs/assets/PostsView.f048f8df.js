import{u as B}from"./index.0402c973.js";import{_ as k}from"./_plugin-vue_export-helper.cdc0426e.js";import{o,c as i,a as e,t as r,f as D,g as y,r as O,d as v,F as x,h as w,i as P,j as _,k as N,v as R,p as T,e as U,l as F,m as A,u as m,b as j,w as E,n as H}from"./index.ded409d8.js";import{a as C}from"./axios.0a901153.js";const Y="/favicon.png",{cookies:V}=B();class M{logout(n){V.remove("user"),n.go(n.currentRoute)}getUser(){return V.get("user")}}const q={props:["body","autor"]},z={class:"border rounded px-2 pt-2 mb-2 comment"},G={class:"d-flex align-items-center mb-2"},J={class:"fs-6 my-auto"},K={class:"fs-5 body"};function Q(s,n,t,g,l,d){return o(),i("div",z,[e("div",G,[e("p",J,r(t.autor),1)]),e("p",K,r(t.body),1)])}const W=k(q,[["render",Q],["__scopeId","data-v-3c3cf92e"]]);const X={props:["titulo","body","tags","autor","imgurl","id"],components:{ComentarioComponent:W},data(){return{comments:D([]),loading:!1,levecommode:!1,newcom:y(""),userService:new M}},methods:{loadComments(){this.comments.length==0&&(this.loading=!0,C(`https://dummyjson.com/posts/${this.id}/comments`).then(s=>{this.comments=s.data.comments,this.loading=!1}))},enterCommentMode(){this.levecommode=!0},sendCommentario(){this.levecommode=!1;const s=this.userService.getUser();this.comments.push({body:this.newcom,user:{username:s?s.username:"anonymous"}}),this.newcom=""}}},$=s=>(T("data-v-c9e61692"),s=s(),U(),s),Z={class:"fs-4 mb-0"},ee={class:"d-flex align-items-center mb-2"},te=["src"],se={class:"fs-6 my-auto"},oe={class:"bg-success text-white px-2 rounded-pill mx-1"},ne={class:"fs-5 body px-3"},ae=["id"],ie={class:"accordion-item"},le=["id"],de=["data-bs-target","aria-controls"],ce=["id","aria-labelledby","data-bs-parent"],re={class:"accordion-body d-flex justify-content-center row"},ue={class:"d-flex row"},me={key:1,class:"d-flex"},_e={class:"form-floating form-comentario"},ge=$(()=>e("label",{for:"floatingInput"},"Comentario",-1)),be=$(()=>e("i",{class:"bi bi-send-fill"},null,-1)),pe={key:0,class:"spinner-border text-primary",role:"status"},he=$(()=>e("span",{class:"visually-hidden"},"Loading...",-1)),fe=[he];function ve(s,n,t,g,l,d){const h=O("ComentarioComponent");return o(),i("div",null,[e("p",Z,r(t.titulo),1),e("div",ee,[e("img",{src:t.imgurl,class:"border rounded-circle border-dark me-1"},null,8,te),e("p",se,[v(r(t.autor)+" ",1),(o(!0),i(x,null,w(t.tags,a=>(o(),i("span",oe,r(a),1))),256))])]),e("p",ne,r(t.body),1),e("div",{class:"accordion accordion-flush",id:"accordionFlushExample"+t.id},[e("div",ie,[e("h2",{class:"accordion-header btn-post-comment",id:"flush-headingOne"+t.id},[e("button",{class:"accordion-button collapsed",type:"button","data-bs-toggle":"collapse","data-bs-target":"#flush-collapseOne"+t.id,"aria-expanded":"false","aria-controls":"flush-collapseOne"+t.id,onClick:n[0]||(n[0]=a=>d.loadComments())}," Comentarios ",8,de)],8,le),e("div",{id:"flush-collapseOne"+t.id,class:"accordion-collapse collapse","aria-labelledby":"flush-headingOne"+t.id,"data-bs-parent":"#accordionFlushExample"+t.id},[e("div",re,[(o(!0),i(x,null,w(l.comments,a=>(o(),P(h,{body:a.body,autor:a.user.username},null,8,["body","autor"]))),256)),e("div",ue,[l.levecommode?_("",!0):(o(),i("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:n[1]||(n[1]=a=>d.enterCommentMode())},"Adicionar comentario")),l.levecommode?(o(),i("div",me,[e("div",_e,[N(e("input",{class:"form-control",id:"floatingInput","onUpdate:modelValue":n[2]||(n[2]=a=>l.newcom=a),placeholder:"muito legal a publica\xE7\xE3o"},null,512),[[R,l.newcom]]),ge]),e("button",{class:"btn btn-success btn-send",type:"button",onClick:n[3]||(n[3]=a=>d.sendCommentario())},[v("Enviar "),be])])):_("",!0)]),l.loading?(o(),i("div",pe,fe)):_("",!0)])],8,ce)])],8,ae)])}const ye=k(X,[["render",ve],["__scopeId","data-v-c9e61692"]]);const p=s=>(T("data-v-77a6a56e"),s=s(),U(),s),xe={class:"bg-img"},we={class:"navbar navbar-expand-lg bg-success"},Ce={class:"container-fluid"},ke=p(()=>e("a",{class:"navbar-brand",href:"/"},[e("img",{src:Y})],-1)),$e=p(()=>e("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarTogglerDemo02","aria-controls":"navbarTogglerDemo02","aria-expanded":"false","aria-label":"Toggle navigation"},[e("span",{class:"navbar-toggler-icon"})],-1)),Le={class:"collapse navbar-collapse",id:"navbarTogglerDemo02"},Ie=p(()=>e("ul",{class:"navbar-nav me-auto mb-2 mb-lg-0"},null,-1)),Se={key:0,class:"btn-group"},je={type:"button",class:"d-flex align-items-center btn dropdown-toggle text-info","data-bs-toggle":"dropdown","aria-expanded":"false"},Ee=["src"],Ve={class:"mb-0 ms-2"},Be={class:"dropdown-menu"},De={key:1,class:"btn-group"},Oe=p(()=>e("button",{type:"button",class:"d-flex align-items-center btn dropdown-toggle text-info","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"bi bi-person-circle user-img"}),e("p",{class:"mb-0 text-info"},"Anonymous")],-1)),Pe={class:"dropdown-menu"},Te={id:"main",class:"d-flex flex-column align-items-center justify-content-center mx-0"},Ue={class:"mt-2",style:{display:"flex","justify-content":"flex-end",width:"80%"}},Me={class:"flex-col align-items-center justify-content-center mt-2",style:{width:"80%"}},Ne=p(()=>e("span",{class:"visually-hidden"},"Loading...",-1)),Re=[Ne],Fe={__name:"PostsView",setup(s){const n=new M,{cookies:t}=B();let g=0;const l=10,d=t.get("user"),h=D([]),a=y(!0),L=y(null),I=()=>{C.get(`https://dummyjson.com/posts?limit=${l}&skip=${g*l}`).then(f=>{g*l<f.data.total?(f.data.posts.forEach(c=>{C.get(`https://dummyjson.com/users/${c.userId}?select=username,image`).then(b=>{h.push({id:c.id,title:c.title,body:c.body,tags:c.tags,username:b.data.username,imgurl:b.data.image})})}),g++):a.value=!1})};F(()=>{window.addEventListener("scroll",S)}),A(()=>{window.removeEventListener("scroll",S)});const S=f=>{a.value&&L.value.getBoundingClientRect().bottom<window.innerHeight&&I()};return I(),(f,c)=>{const b=O("RouterLink");return o(),i("div",xe,[e("nav",we,[e("div",Ce,[ke,$e,e("div",Le,[Ie,e("div",null,[m(d)?(o(),i("div",Se,[e("button",je,[e("img",{src:m(d).image,class:"border rounded-circle border-dark me-1 user-img"},null,8,Ee),e("p",Ve,r(m(d).username),1)]),e("ul",Be,[e("li",null,[e("a",{class:"dropdown-item",onClick:c[0]||(c[0]=()=>m(n).logout(m(H)))},"Logout")])])])):_("",!0),m(d)?_("",!0):(o(),i("div",De,[Oe,e("ul",Pe,[e("li",null,[j(b,{class:"dropdown-item",to:"/login"},{default:E(()=>[v("Login")]),_:1})])])]))])])])]),e("main",Te,[e("div",Ue,[j(b,{to:"/posts/new",class:"btn rounded-pill btn-success border text-white"},{default:E(()=>[v("+ adicionar")]),_:1})]),e("div",Me,[(o(!0),i(x,null,w(h,u=>(o(),P(ye,{id:u.id,titulo:u.title,body:u.body,tags:u.tags,autor:u.username,class:"border px-2 rounded mb-2 post",imgurl:u.imgurl,style:{width:"100%"}},null,8,["id","titulo","body","tags","autor","imgurl"]))),256))]),a.value?(o(),i("div",{key:0,class:"spinner-border text-purple-1 my-2",ref_key:"scrollComponent",ref:L,role:"status"},Re,512)):_("",!0)])])}}},ze=k(Fe,[["__scopeId","data-v-77a6a56e"]]);export{ze as default};
